import { DocLayout } from "../../../app/components/Learn/DocLayout";

export const meta = {
  title: "Measles Virus Analysis - Case Study",
  description:
    "From data to publication in a browser: Evolutionary dynamics of coding overlaps in measles virus",
};

export default ({ children }) => (
  <DocLayout title={meta.title} description={meta.description}>
    {children}
  </DocLayout>
);

# From data to publication in a browser with BRC-Analytics: Evolutionary dynamics of coding overlaps in measles virus

Anton Nekrutenko<sup>1</sup>, Danielle Callan<sup>2</sup>, Marius Van Den Beek<sup>1</sup>, Dannon Baker<sup>3</sup>, David Rogers<sup>4</sup>, Wolfgang Maier<sup>5</sup>, Aysam Guerler<sup>3</sup>, Hiram Clawson<sup>6</sup>, Scott Cain<sup>1</sup>, Kelsey Beavers<sup>8</sup>, Maximilah Haeussler<sup>6</sup>, Bjorn Gruning<sup>5</sup>, and Sergei Kosakowsky Pond<sup>2</sup>

<sup>1</sup> Dept. of Biochemistry and Molecular Biology, The Pennsylvania State
University, University Park, PA, USA
<sup>2</sup> Dept. of Biology, Temple University, Philadelphia, PA, USA
<sup>3</sup> Dept. of Biology, Johns Hopkins University, Baltimore, MD, USA
<sup>4</sup> Clever Canary, LLC, Santa Cruz, CA, USA
<sup>5</sup> Dept. of Bioinformatics, Albert-Ludwigs-University Freiburg,
Freiburg, Baden-Württemberg, Germany
<sup>6</sup> Baskin School of Engineering, University of California, Santa Cruz,
USA
<sup>7</sup> NCBI Datasets, National Library of Medicine, NIH, Bethesda, MD, USA
<sup>8</sup> Texas Advanced Computing Center, The University of Texas, Austin,
TX, USA

## Abstract

The analytical landscape of pathogen research is often fragmented, hindering transparency and reproducibility due to diverse genomic data sources, numerous analysis tools, and suboptimal integration methods. This manuscript introduces BRC-analytics, a novel browser-based environment that unifies authoritative sources of genomic data with community-curated best analysis practices on a freely accessible public computational infrastructure. We demonstrate its capabilities by analyzing the evolutionary dynamics within the P/V/C locus of the measles virus, a complex system involving overlapping coding regions and RNA editing. Our analysis, conducted entirely within BRC-analytics, reveals asymmetric evolution of the locus's reading frames under distinct selective pressures. BRC-analytics streamlines the entire research process—from data collection and primary analysis (e.g., variant calling) to interpretation (e.g., using integrated JupyterLite notebooks and LLMs) and publication—into a single web browser session. This eliminates the need for local installations and manual data transfers, implicitly tracking provenance and ensuring reproducibility. The platform's ultimate goal is to provide true data-to-publication functionality, making advanced pathogen genomics accessible to a broader research community regardless of their computational expertise or infrastructure access.

## Introduction

Any study, from data to publication, includes four fundamental steps: (1) data collection, (2) primary analysis, (3) interpretation, and, ultimately, (4) publication itself. The unique aspect of BRC-analytics is that all these steps can be performed in one place without leaving a single web browser session. Until now it was not possible. First, necessary datasets such as reference genomes, annotations, and sequencing reads can be found at standard repositories such as NCBI or EBI. But they need to be downloaded to be used for the analysis. Second, the primary analysis—beginning with sequencing reads and producing variant lists, transcript counts, etc.—can be performed with a variety of standard tools and pipelines. This is still challenging for many researchers: they need to be aware of which tool combination makes sense given the data/experimental design, how to install and configure them, and where to run them. The ubiquity of LLM chatbots can significantly smooth the installation and configuration process for many researchers but it hardly makes their analyses more reproducible. While in many cases modern laptops can be sufficient for running small-to-medium size analyses, surveys involving thousands of samples require dedicated resources. Third, for the interpretation phase there are no dedicated tools. Instead this stage is performed using general analysis utilities ranging from spreadsheets to custom code executed in computational notebooks. Because custom code is rarely properly versioned and documented these analyses cannot be easily reproduced by researchers outside the group that conducted the analysis in the first place.

BRC-analytics encompasses the entire data-to-publication trajectory by providing access to reference genomes and annotations as well as all publicly available data from the sequence read archive (SRA) and combines it with community-curated best-practice analysis workflows and tools. All of this is built on top of the free public computational resources. To highlight the functionality of BRC-analytics we picked one of the most common types of analyses: pathogen surveillance. In this analysis data from multiple spatially and temporally distributed samples is processed to identify sequence variants (SVs). This is done by aligning reads against a reference genome, calling variants and ultimately generating variant lists: locations and identities of SVs found in each sample. These SVs are further processed to uncover underlying patterns such as dynamics of variants in space and time and ultimately estimate their potential effects on the fitness of the pathogen. Before moving to practicalities let us deconstruct this analysis into data collection, primary analysis, interpretation, and publication strategies mentioned earlier (Table 1).

### Table 1: The four stages of a biomedical research project

| **Stage**        | **Action**                                                                                                                 | **Standardization / Reproducibility potential** | **Outcome**                                  |
| ---------------- | -------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------- | -------------------------------------------- |
| Data collection  | Specimen collection and sequencing                                                                                         | -                                               | Sequencing data (fastq files)                |
| Primary analysis | Use of standard tools for QC, Read mapping, variant calling, filtering, etc.                                               | High                                            | Variant lists (VCF, TSC, CSV, etc.)          |
| Interpretation   | Custom scripts for tracing variants through samples, times, or locations. Analysis of variant effects on pathogen biology. | Low                                             | Spreadsheets, notebooks, figures             |
| Reporting        | Generation of final tables, figures, reports                                                                               | Low                                             | Reports, dashboards, preprints, publications |

Outside of BRC-analytics all of these steps are performed separately. Suppose a student in a lab performs re-analysis of published surveillance datasets. These datasets—fastq files from the sequence read archive (SRA) such as NCBI or EBI—are first downloaded onto local infrastructure. Next, these data need to be mapped against a reference genome for the pathogen in question. For this the reference also needs to be located and downloaded. At this point using a combination of tools or workflows, read data is reduced to a list of variants. Depending on how (individual tool or Snakemake, Nextflow, or Galaxy workflows) and where (one's laptop, an institutional cluster, a cloud, a Galaxy instance) this is done, the results may be more or less reproducible. The interpretation stage involves filtering, reshaping and summarizing the list of variants. It is done using "analytical frameworks" such as spreadsheets applications or notebooks (Jupyter, RStudio). This is the least reproducible stage of the analysis because spreadsheet formulas and/or custom code created in notebooks is rarely versioned or documented. The entire process is usually condensed into a sentence "the data was analyzed using a collection of in-house python scripts" found in too many methods sections of numerous manuscripts. Because BRC-analytics integrates all these steps into a single environment it tracks provenance implicitly saving all parameters, intermediate datasets, or code snippets in notebooks addressing most reproducibility concerns.

## Results and Discussion

### What is BRC-analytics?

BRC-Analytics is a browser-based analysis environment developed within the NIAID-funded Bioinformatics Resource Centers (BRCs) program to enable comprehensive, reproducible genomic and metagenomic analyses of infectious disease agents entirely online. Powered by the Galaxy workflow system, it integrates reference data from NCBI Datasets and curated community workflows for quality control, read mapping, variant identification, and annotation. Users can start with raw sequencing reads and obtain publication-ready results without installing software or transferring data between tools. By combining cloud-based computation, versioned workflows, and interactive visualizations, BRC-Analytics provides a seamless interface that unites the data and analytical capabilities making advanced pathogen genomics accessible to the wider research community.

At the moment of writing BRC-analytics listed 1,601 genome assemblies corresponding to 1,149 distinct pathogen, host, and vector taxa. Our plan is to steadily increase the number of species until all NCBI Datasets taxa are included. We use UCSC Genome Browser platform as a source of genome annotations (coordinates of genes, regulatory element, etc). This involves ensuring that for each NCBI genome assembly we have a corresponding UCSC Genome Browser instance populated with annotations. Using UCSC Genome Browser as a distribution platform for genome annotation allows us to be more flexible and include community annotations in addition to reference tracks provided by NCBI datasets. Finally, for accessing all public sequence read archive (SRA) data we rely on EBI ENA by locally caching all SRA metadata for quick search and accessing read-level data via ENA API. Best practice workflows are retrieved from the community curated Galaxy's IWC consortium repository. BRC-analytics uses Galaxy for launching and running workflows as well as individual analysis tools. Galaxy is also used as an environment for interpretive analyses by relying on its interactive environment and visualization functionality powered by Jupyter, RStudio, and JupyterLite. The substantial computational and storage capacities required to make this system work and scale are provided by the ACCESS-CI infrastructure in the US. BRC-analytics and Galaxy are hosted on servers provided by the Texas Advanced Computing Center (TACC)—an integral part of ACCESS-CI.

### Selecting genome: Using NCBI Datasets for reference data

The analysis begins at [https://brc-analytics.org](https://brc-analytics.org) where we search for _Morbillivirus hominis_—a binary name for measles virus (a new standard for official scientific names implemented by the international committee on taxonomy of viruses). The search yields a single assembly, GCF_000854845.1, corresponding to the only RefSeq genome for measles. In the remainder of this document we refer to the measles virus as MeV.

[Watch Video 1: Selecting genome](https://youtu.be/24xJmywy_Nk)

### Replicating this analysis

Everything described in this manuscript can be re-examined and replicated. The table below provides links and description to key artifacts of this analysis:

| **Artifact**     | **Link**                                                                                     | **Description**                                                                                                                                                                                    |
| ---------------- | -------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Analysis history | [Galaxy History](https://usegalaxy.org/u/cartman/h/overlaps-in-measels-1)                    | Galaxy history is the workspace in which the analysis is conducted. It contains all inputs, intermediate datasets and outputs. JupyterLite notebooks used in the analysis can also be found there. |
| Workflow         | [DOI: 10.5281/zenodo.16896089](https://doi.org/10.5281/zenodo.16896089)                      | Variants calling workflow used to generate variant lists for this analysis. The history above contains data generated by this workflow.                                                            |
| Videos           | [YouTube Playlist](https://www.youtube.com/playlist?list=PLNFLKDpdM3B-YdpZjoCxtFNUztnmkMu9l) | Videos describing each stage of this study.                                                                                                                                                        |

Clicking the history link will allow you to import that history in your own workspace and re-examine or re-run every step.

### Selecting analysis: Using community-curated workflows

Our goal is to perform a variant identification analysis: sequence data (reads) are mapped against a reference genome and mismatches between the reads and the genome are evaluated to identify likely changes. Such an analysis requires multiple tools for evaluation of data quality, read mapping, and variant identification along with auxiliary utilities. The most optimal way to run an analysis like this is to assemble tools into a workflow. There are already community developed and maintained collections of workflows covering the absolute majority of sequence analysis scenarios. BRC-Analytics tries to match an assembly to a list of potential workflows that are applicable to it. For example, in the case of the measles virus BRC-analytics offers two variant calling workflows. For this study we are using a workflow called "Variant calling and consensus construction from paired end short read data of non-segmented viral genomes". This workflow was specifically designed for non-segmented viruses with a low-to-medium evolutionary rate such as MeV.

Detailed information about the workflow can be found at:

- [IWC - Galaxy's workflow repository](https://iwc.galaxyproject.org/workflow/generic-non-segmented-viral-variant-calling-main/)
- [Dockstore](https://dockstore.org/workflows/github.com/iwc-workflows/generic-non-segmented-viral-variant-calling/main:main?tab=info)

The workflow produces several types of outputs: a summary of variants found in each sample, consensus sequence for each sample as well as auxiliary outputs such as QC summary for all samples.

[Watch Videos 1 & 2: Selecting and launching workflows](https://www.youtube.com/playlist?list=PLNFLKDpdM3B-YdpZjoCxtFNUztnmkMu9l)

### Selecting SRA data and launching workflow

After selecting the reference genome and workflow for variant identification analysis, we chose public surveillance data for the virus. BRC-analytics' SRA search wizard initially showed 466 individual datasets. These were automatically pre-filtered to 225 samples across nine studies, based on the workflow's requirements for "paired end" (Illumina or Element) and "WGS" (whole genome sequencing) data; these filters can be adjusted as needed. Among these nine studies were the three largest measles surveillance datasets (Table 2), which we selected to launch the previously described workflow.

#### Table 2: Three MeV surveillance datasets selected for this study

| Study        | Description                                                                                      | # samples | Reference                                        |
| ------------ | ------------------------------------------------------------------------------------------------ | --------- | ------------------------------------------------ |
| PRJNA1145141 | Analysis of measles outbreak in Romania.                                                         | 124       | [Ref](https://pubmed.ncbi.nlm.nih.gov/39813269/) |
| PRJNA1017431 | Canadian measles surveillance data.                                                              | 61        | [Ref](https://pubmed.ncbi.nlm.nih.gov/38038439/) |
| PRJNA869081  | Measles virus transmission patterns and public health responses during Operation Allies Welcome. | 42        | [Ref](https://pubmed.ncbi.nlm.nih.gov/37516478/) |

The workflow outputs two datasets that would help us gain insights into the evolution of overlapping coding regions in the measles virus. The first dataset provides information about each variant within each sample: it shows its position, alternative allele frequency, strand-specific read counts, functional impact and other data. The second dataset contains consensus sequences produced for each sample by incorporating all variants present in that sample. We will use it to assess adaptive significance of substitutions.

### Making sense of variants: Combining LLMs and JupyterLite

The workflow described above produced a list of variants observed in each sample. Such a list by itself does not provide any valuable biological insights. It needs to be reshaped, summarized, and visualized to give us any ideas on the biological significance of variants we just identified. Additional complication is that there are no "off-the-shelf" tools for analysis of genetic variants in overlapping coding regions. Fortunately, BRC-analytics and Galaxy it utilizes as the analysis platform provide ability to construct analyses in an _ad-hoc_ way. For this we will use an environment called JupyterLite that is integrated into the Galaxy platform.

[Watch Video 3: Analysis with JupyterLite](https://youtu.be/plwNw_PcUgE?si=mMe4IpCFIG9_WYkZ)

The entire analysis including the notebook can be accessed through the links provided above. All steps of this analysis described in the notebook were generated with the help of ChatGPT using a setup in which we used two open browser windows: one with Galaxy workspace and another with ChatGPT, Microsoft CoPilot, Claude, or any other LLM agent capable of writing python code. Video 3 also details safety checks we used when using LLM-generated code—such code should ALWAYS be treated with extreme caution and made publicly available.

### Key findings

The analysis revealed asymmetric evolution of the P/V/C locus's reading frames under distinct selective pressures:

1. **P reading frame is more permissive than C and V**: Most substitutions are non-synonymous in P and synonymous in C or V, suggesting the P reading frame appears to be more permissive.

2. **Strong purifying selection on C protein**: Variants in the C–P overlap are mostly synonymous in C but nonsynonymous in P. This suggests strong purifying selection on C (which contains nuclear localization, export, and SHCBP1-binding signals), while P tolerates or favors amino-acid changes in this region.

3. **P-directed adaptation**: Substitutions in the P–V overlap frequently show synonymous changes in V but nonsynonymous in P, pointing to P-directed adaptation.

4. **V-specific adaptive evolution**: Some sites show the opposite pattern (nonsynonymous in V, synonymous in P), possibly corresponding to residues that mediate STAT1 and Jak1 binding. These variants could represent V-specific adaptive evolution affecting interferon antagonism.

## Conclusion

This case study demonstrates how BRC-analytics enables sophisticated evolutionary and functional analyses without local installations or manual data transfers. The platform successfully integrates:

- **Data collection** from authoritative sources (NCBI, ENA)
- **Primary analysis** using community-curated workflows
- **Interpretation** with JupyterLite notebooks and LLM assistance
- **Publication** with complete provenance tracking

All analysis steps can be reproduced through the provided Galaxy history and workflows, ensuring transparency and reproducibility in pathogen genomics research.

## Related Resources

- [Running a Workflow](/learn/tutorials/workflow) - Learn how to configure and launch workflows
- [Working with Data](/learn/tutorials/data) - Guide to managing genomic data in BRC Analytics
- [API Documentation](/learn/reference/api) - Technical reference for programmatic access

export async function getStaticProps() {
  return {
    props: {
      pageTitle: meta.title + " - Learn BRC Analytics",
      themeOptions: {
        palette: { background: { default: "#FAFBFB" } },
      },
    },
  };
}
